{
    "collab_server" : "",
    "contents" : "'''\nThis script creates some simple graphics using metrics\nfrom the Optimization tool\n'''\n\n### Set up\nlibs  <- c(\"tidyverse\", \"extrafont\", \"stringr\") \nlapply(libs, library, character.only = TRUE)\nloadfonts(device = 'win')\nsetwd(\"C:\\\\Users\\\\wsmorgan\\\\Dropbox (ASU)\\\\643 Charts (Personal)\")\n\n### Bring in text files and convert to data frame\nreadOpt <- function(file) {\n  lines <- read_lines(file) %>%\n    str_replace('Counts: ', '') %>%\n    str_replace('Sequences: ', '') %>%\n    str_replace(\": \", \"\") %>%\n    str_replace(\"%\", \"\")\n  \n  df <- tibble(\n    team = window(lines, deltat = 4),\n    counts = as.numeric(window(lines, 2, deltat = 4)) / 100,\n    sequences = as.numeric(window(lines, 3, deltat = 4)) / 100\n  )\n  \n  return(df)\n}\n\nbefore <- readOpt(\"Before Optimization - Metrics.txt\") %>%\n  rename(before_ct = counts, \n         before_seq = sequences)\n\nafter <- readOpt(\"After Optimization - Metrics.txt\") %>%\n  rename(after_ct = counts,\n         after_seq = sequences)\n\novall <- inner_join(before, after) %>%\n  mutate(seq_improv = after_seq - before_seq,\n         ct_improv = after_ct - before_ct)\n\nrm(before, after)\n\n\n### Team improvements in sequences, counts\n## Simple bar graphs\n\novall %>%\n  arrange(desc(seq_improv)) %>%\n  slice(1:10) %>%\n  ggplot(aes(x = reorder(team, seq_improv), y = seq_improv)) +\n  geom_bar(fill = '#ABD375', stat = 'identity') +\n  geom_text(aes(label = round(ct_improv, 2)), color = 'black', hjust = -.25) + \n  labs(title = \"Most Improved Sequence Data\", x = \"\", y = \"Percent Improved\") +\n  theme_solarized_2() +\n  theme(plot.title = element_text(hjust = .5, color = 'black'), axis.title = element_text(color = 'black'), \n        text = element_text(color = 'black'), axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n        panel.background = element_blank(), axis.line = element_line(colour = \"black\")) +\n  coord_flip(ylim = c(.4,1))\nggsave(\"Optimization Graphics/most_improved_seq_bar.png\")\n\novall %>%\n  arrange(desc(ct_improv)) %>%\n  slice(1:10) %>%\n  ggplot(aes(x = reorder(team, ct_improv), y = ct_improv)) +\n  geom_bar(fill = '#ABD375', stat = 'identity') +\n  geom_text(aes(label = round(ct_improv, 2)), color = 'black', hjust = -.25) + \n  labs(title = \"Most Improved Count Data\", x = \"\", y = \"Percent Improved\") +\n  theme_solarized_2() +\n  theme(plot.title = element_text(hjust = .5, color = 'black'), axis.title = element_text(color = 'black'), \n        text = element_text(color = 'black'), axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n        panel.background = element_blank(), axis.line = element_line(colour = \"black\")) +\n  coord_flip(ylim = c(.65,1))\nggsave(\"Optimization Graphics/most_improved_ct_bar.png\")\n\n\n### Histogram of improvements\n\n# Sequences\novall %>%\n  filter(seq_improv > 0) %>%\n  ggplot(aes(x = seq_improv)) +\n  geom_histogram(fill = '#ABD375', color = 'black') +\n  labs(title = \"Sequence Improvement Distribution\", x = \"Percent Improvement\", y = \"Number of Teams\") +\n  theme_solarized_2() +\n  theme(plot.title = element_text(hjust = .5, color = 'black'), axis.title = element_text(color = 'black'), \n        text = element_text(color = 'black'),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n        panel.background = element_blank(), axis.line = element_line(colour = \"black\"))\nggsave(\"Optimization Graphics/seq_improv_hist.png\")\n\n# Counts\novall %>%\n  filter(ct_improv > 0) %>%\n  ggplot(aes(x = ct_improv)) +\n  geom_histogram(fill = '#ABD375', color = 'black') +\n  labs(title = \"Count Improvement Distribution\", x = \"Percent Improvement\", y = \"Number of Teams\") +\n  theme_solarized_2() +\n  theme(plot.title = element_text(hjust = .5, color = 'black'), axis.title = element_text(color = 'black'), \n        text = element_text(color = 'black'),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n        panel.background = element_blank(), axis.line = element_line(colour = \"black\"))\nggsave(\"Optimization Graphics/ct_improv_hist.png\")\n\n\n### Improvement Scatter\nggplot(ovall, aes(ct_improv, seq_improv)) +\n  geom_point(color = \"#09562c\", size = 1.5) + \n  geom_smooth(method = 'glm', se = FALSE, color = 'darkorange3') + \n  annotate(\"text\", x = .25, y = .9, label = \"Expected Count Improvement = 19.2%\\n Expected Seq Improvement = 16.4%\",\n           fontface = 3) +\n  labs(title = \"Overall Improvements\", x = \"Count\", y = \"Sequence\") +\n  theme_solarized_2() +\n  theme(plot.title = element_text(hjust = .5, color = 'black'), axis.title = element_text(color = 'black'), \n        text = element_text(color = 'black', family = \"Akzidenz-Grotesk\"),\n        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),\n        panel.background = element_blank(), axis.line = element_line(colour = \"black\"))\nggsave(\"Optimization Graphics/improvement_scatter.png\")\n\n### Working notes:\n# standardize fonts\n\n\n\n\n\n\n\n",
    "created" : 1513186939173.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3515914592",
    "id" : "A0383456",
    "lastKnownWriteTime" : 1513194407,
    "last_content_update" : 1513194407972,
    "path" : "D:/W. Morgan/Dropbox (ASU)/643 Charts (Personal)/R Scripts/Optimization graphics.R",
    "project_path" : null,
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}